<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Construction Risk Dashboard - Secure Login</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        /* Global Styles */
        body {
            font-family: 'Inter', sans-serif;
            margin: 0;
            padding: 0;
            height: 100vh;
            width: 100vw;
            overflow: hidden; /* Prevent scrolling */
        }

        /* Full-screen containers for both login and dashboard */
        .full-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Custom styling for the login card backdrop */
        .login-card-bg {
            background-color: #f4f7f9;
            background-image: linear-gradient(135deg, #1f3d7a 0%, #3e81e3 100%);
        }

        /* Iframe styling */
        iframe {
            width: 100%;
            height: 100%;
            border: none;
            display: block;
        }
    </style>
</head>
<body>

    <!-- 1. LOGIN SCREEN (Initial State) -->
    <div id="login-page" class="full-screen login-card-bg">
        <div class="bg-white p-8 md:p-10 rounded-xl shadow-2xl w-full max-w-md transition-all duration-300">
            <h1 class="text-3xl font-bold text-center text-gray-800 mb-2 flex items-center justify-center">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 mr-3 text-blue-600" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd" />
                </svg>
                Opera Risk Dashboard Access
            </h1>
            <p class="text-center text-sm text-gray-500 mb-8">Secure access to construction project risk data.</p>
            
            <form id="login-form" onsubmit="event.preventDefault(); handleLogin();">
                <!-- Error Message -->
                <div id="error-message" class="hidden bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4" role="alert">
                    <strong class="font-bold">Error!</strong>
                    <span class="block sm:inline"> Invalid Password.</span>
                </div>

                <!-- Email field REMOVED -->
                
                <div class="mb-6">
                    <label for="password" class="block text-sm font-medium text-gray-700 mb-1">Access Password</label>
                    <input type="password" id="password" name="password" required 
                           class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 transition duration-150"
                           placeholder="••••••••">
                </div>
                
                <button type="submit" 
                        class="w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2.5 rounded-lg shadow-md transition duration-200 focus:outline-none focus:ring-4 focus:ring-blue-500 focus:ring-opacity-50">
                    Log In
                </button>
            </form>
        </div>
    </div>

    <!-- 2. DASHBOARD SCREEN (Hidden Initially) -->
    <div id="dashboard-page" class="full-screen" style="display: none;">
        <!-- Embedded Power BI Dashboard -->
        <iframe 
            title="Risk Dashboard - Opera" 
            src="https://app.powerbi.com/view?r=eyJrIjoiYjRjNmZhZDgtYjY3Ni00OWI4LTg2ZjMtZTIyNzU0OTFiYzVkIiwidCI6ImRjYmJhNzgwLTM1M2UtNGU4OC04OWY5LTZmNGZmYTdjODM4YSIsImMiOjl9" 
            allowFullScreen="true">
        </iframe>
    </div>

    <script>
        // --- !!! CRITICAL SECURITY RISK: Obfuscated password in client-side code !!! ---
        // This is NOT secure. The original password (ecmrisk2028) is still recoverable
        // by anyone using the browser's developer tools (Inspect Mode).
        const PASSWORD_CHARS = [101, 99, 109, 114, 105, 115, 107, 50, 48, 50, 56]; //
        
        /**
         *
         * 
         */
        function getRequiredPassword() {
            // This function is run every time the user attempts to log in.
            return String.fromCharCode(...PASSWORD_CHARS);
        }
        // ----------------------------------------------------------------------------------

        /**
         * Handles the login attempt by comparing user input to the single hardcoded password.
         */
        function handleLogin() {
            const passwordInput = document.getElementById('password').value;
            const errorElement = document.getElementById('error-message');
            const loginPage = document.getElementById('login-page');
            const dashboardPage = document.getElementById('dashboard-page');

            // Retrieve the password using the obfuscation function
            const REQUIRED_PASSWORD = getRequiredPassword();

            // 1. Check Password
            if (passwordInput === REQUIRED_PASSWORD) {
                // 2. Success: Transition to Dashboard
                errorElement.classList.add('hidden');
                
                // Hide login, show dashboard
                loginPage.style.display = 'none';
                dashboardPage.style.display = 'flex'; // Use flex to maintain full-screen alignment
            } else {
                // 3. Failure: Show Error
                errorElement.classList.remove('hidden');
            }
        }
    </script>
</body>
</html>
